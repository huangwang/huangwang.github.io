<!DOCTYPE html>






  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.2.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.2.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Jack Huang&#39;s Blog">
<meta property="og:url" content="https://huangwang.github.io/index.html">
<meta property="og:site_name" content="Jack Huang&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Jack Huang">
<meta property="article:tag" content="Blog">
<meta name="twitter:card" content="summary">






  <link rel="canonical" href="https://huangwang.github.io/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Jack Huang's Blog</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jack Huang's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>




<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://huangwang.github.io/2025/02/26/DeepSeek%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jack Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack Huang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/02/26/DeepSeek%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%E6%96%B9%E6%B3%95/" itemprop="url">
                  DeepSeek大模型本地部署方法
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2025-02-26 22:22:54" itemprop="dateCreated datePublished" datetime="2025-02-26T22:22:54+08:00">2025-02-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2025-02-27 22:21:49" itemprop="dateModified" datetime="2025-02-27T22:21:49+08:00">2025-02-27</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>DeepSeek如此火热，不禁也研究一下本地部署DeepSeek的方法。</p>
<h1 id="Ollama-安装和使用"><a href="#Ollama-安装和使用" class="headerlink" title="Ollama 安装和使用"></a>Ollama 安装和使用</h1><blockquote>
<p>Ollama是一款启动并运行大型语言模型的工具。</p>
</blockquote>
<blockquote>
<p>安装完成后，我们直接打开命令行执行 ollama –version 判断是否安装成功。</p>
</blockquote>
<blockquote>
<p>ollama 会在我们本地服务监听 11434 端口。</p>
</blockquote>
<h2 id="在线部署大模型"><a href="#在线部署大模型" class="headerlink" title="在线部署大模型"></a>在线部署大模型</h2><blockquote>
<p>我们可以直接使用 ollama run 模型名称 来下载和运行我们想要的模型。例如：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 查看ollama版本</span><br><span class="line">ollama --version</span><br><span class="line"># 下载大模型</span><br><span class="line">ollama pull deepseek--r1:1.5b</span><br><span class="line"># 运行大模型</span><br><span class="line">ollama run deepseek-r1:1.5b</span><br></pre></td></tr></table></figure>

<h2 id="离线部署大模型"><a href="#离线部署大模型" class="headerlink" title="离线部署大模型"></a>离线部署大模型</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 在联网生成大模型描述文件</span><br><span class="line">ollama show deepseek-r1:1.5b --modelfile &gt; modelfile.txt</span><br><span class="line"></span><br><span class="line"># 复制大模型和大模型描述文件到离线电脑某个文件夹，然后使用如下命令离线部署</span><br><span class="line">ollama create deepseek-r1:1.5b -f modelfile.txt</span><br><span class="line"></span><br><span class="line"># 验证是否离线部署成功</span><br><span class="line">ollama list</span><br></pre></td></tr></table></figure>

<h1 id="与AI交互的客户端"><a href="#与AI交互的客户端" class="headerlink" title="与AI交互的客户端"></a>与AI交互的客户端</h1><h2 id="ChatBox"><a href="#ChatBox" class="headerlink" title="ChatBox"></a>ChatBox</h2><blockquote>
<p>Chatbox 是一款开源的 AI 客户端，专为与各种大型语言模型进行交互而设计。它支持包括 Ollama 在内的多种主流模型的 API 接入，无论是本地部署的模型，还是其他服务提供商的模型，都能轻松连接。</p>
</blockquote>
<h2 id="Page-Assist-Ollama-实现本地模型联网"><a href="#Page-Assist-Ollama-实现本地模型联网" class="headerlink" title="Page Assist + Ollama - 实现本地模型联网"></a>Page Assist + Ollama - 实现本地模型联网</h2><blockquote>
<p>Chatbox 提供了联网功能，但是 DeepSeek R1 模型是没办法联网。</p>
</blockquote>
<blockquote>
<p>想要让本地模型联网我们还得靠一个浏览器插件 Page Assist。</p>
</blockquote>
<blockquote>
<p>Page Assist 是一款开源的浏览器扩展程序，旨在为本地 AI 模型（如 Ollama）提供便捷的交互界面。</p>
</blockquote>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a href="https://zhuanlan.zhihu.com/p/22699135850" target="_blank" rel="noopener">如何拥有一个无限制、可联网、带本地知识库的私人 DeepSeek？</a>,by ConardLi​.</li>
<li><a href="https://zhuanlan.zhihu.com/p/25054526736" target="_blank" rel="noopener">如何把你的 DeePseek-R1 微调为某个领域的专家？</a>,by ConardLi​.</li>
<li><a href="https://zhuanlan.zhihu.com/p/25911959907" target="_blank" rel="noopener">DeepSeek + Cherry Studio：简捷搭建个人知识库</a>,by 苏点点.</li>
<li><a href="https://deepseek.csdn.net/67c02dcf6670175f992c57dd.html" target="_blank" rel="noopener">打造DeepSeek最强外挂！一篇文章教会你搭建「个人知识库」（喂饭版）</a>,by m0_63171455.</li>
<li><a href="https://zhuanlan.zhihu.com/p/678196390" target="_blank" rel="noopener">LLM context 长度分析与提升方法总结</a>,by phynlp.</li>
<li><a href="https://www.reddit.com/r/ollama/comments/1fm67bw/what_do_you_mean_exactly_with_embedding_length/" target="_blank" rel="noopener">What do you mean exactly with “embedding length” ?</a>,by reddit.</li>
<li><a href="https://medium.com/@techresearchspace/what-is-quantization-in-llm-01ba61968a51" target="_blank" rel="noopener">What is Quantization in LLM</a>,by Nithin Devanand.</li>
<li><a href="https://github.com/karminski/one-small-step/blob/main/20250129-what-is-quantization-in-LLM/what-is-quantization-in-LLM.md" target="_blank" rel="noopener">什么是大语言模型量化? 每个量化精度都代表什么?</a>,by karminski.</li>
<li><a href="https://www.53ai.com/news/LargeLanguageModel/2024073165281.html" target="_blank" rel="noopener">大模型｜“上下文长度”和“上下文窗口”不再傻傻分不清楚！</a>,by 智识可乐.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://huangwang.github.io/2025/02/04/QT-GUI%E6%8F%92%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA%E6%96%B9%E6%B3%95%E7%A0%94%E7%A9%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jack Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack Huang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/02/04/QT-GUI%E6%8F%92%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA%E6%96%B9%E6%B3%95%E7%A0%94%E7%A9%B6/" itemprop="url">
                  QT_GUI插件系统构建方法研究
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2025-02-04 20:09:34 / 修改时间：20:52:56" itemprop="dateCreated datePublished" datetime="2025-02-04T20:09:34+08:00">2025-02-04</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>构建一个较大桌面GUI应用程序，采用插件架构是必由之路。首先插件架构有利于多人分工协作，有利于系统功能的扩展和维护，有利于用户需求的快速响应。</p>
<h1 id="插件架构"><a href="#插件架构" class="headerlink" title="插件架构"></a>插件架构</h1><p>插件架构系统主要由以下三部分构成：</p>
<ul>
<li>主系统，通过插件管理器加载插件，并创建插件对象。</li>
<li>插件管理器，用于管理插件的生命周期，并将其暴露给主系统。</li>
<li>插件，插件本身应符合插件管理器协议，并提供符合主系统期望的对象。</li>
</ul>
<h1 id="QT插件示例"><a href="#QT插件示例" class="headerlink" title="QT插件示例"></a>QT插件示例</h1><p>请参考：</p>
<ul>
<li><a href="https://doc.qt.io/qt-5/qtwidgets-tools-echoplugin-example.html" target="_blank" rel="noopener">Echo Plugin Example </a></li>
</ul>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a href="https://developer.aliyun.com/article/595023" target="_blank" rel="noopener">构建自己的Qt插件系统</a>,by aliyun.</li>
<li><a href="https://blog.csdn.net/qq_33055735/article/details/99653516" target="_blank" rel="noopener">深入理解插件系统</a>,by qq_33055735.</li>
<li><a href="https://doc.qt.io/qt-5/qtwidgets-tools-echoplugin-example.html" target="_blank" rel="noopener">Echo Plugin Example </a>,by qt.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://huangwang.github.io/2025/01/17/%E9%BA%92%E9%BA%9FV10%E8%AE%BE%E7%BD%AEVNC%E8%BF%9E%E6%8E%A5%E7%9A%84%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jack Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack Huang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/01/17/%E9%BA%92%E9%BA%9FV10%E8%AE%BE%E7%BD%AEVNC%E8%BF%9E%E6%8E%A5%E7%9A%84%E6%96%B9%E6%B3%95/" itemprop="url">
                  麒麟V10设置VNC连接的方法
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2025-01-17 18:13:28 / 修改时间：20:06:55" itemprop="dateCreated datePublished" datetime="2025-01-17T18:13:28+08:00">2025-01-17</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近研究了一下麒麟V10 Linux设置VNC连接的方法，记录一下。</p>
<h1 id="VNC-Server配置"><a href="#VNC-Server配置" class="headerlink" title="VNC Server配置"></a>VNC Server配置</h1><p>VNC Server应该能够以服务的形式开机自启动，对外以 80 端口提供VNC远程连接服务。</p>
<h2 id="创建-VNC-Systemd-服务"><a href="#创建-VNC-Systemd-服务" class="headerlink" title="创建 VNC Systemd 服务"></a>创建 VNC Systemd 服务</h2><p>创建VNC Systemd 服务，实现麒麟 V10 开机后 VNC 服务器自启动。暂未成功。</p>
<h2 id="修改-vncserver-配置"><a href="#修改-vncserver-配置" class="headerlink" title="修改 vncserver 配置"></a>修改 vncserver 配置</h2><p>修改 vncserver 配置，使 :1 对应 80 端口。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 查看 vncserver 的位置</span><br><span class="line">which vncserver</span><br><span class="line"></span><br><span class="line"># 查看 vncserver 软连接到哪个文件</span><br><span class="line">file &#x2F;usr&#x2F;bin&#x2F;vncserver</span><br></pre></td></tr></table></figure>

<p>最终找到麒麟 V10 使用的 vncserver 为 TigerVNC，使用 Vim 修改 TigerVNC配置文件，将 5900 替换为 79。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;usr&#x2F;bin&#x2F;tigervncserver</span><br><span class="line"></span><br><span class="line"># 逐个替换并确认</span><br><span class="line">:%s&#x2F;5900&#x2F;79&#x2F;gc</span><br></pre></td></tr></table></figure>

<h2 id="修改-sysctl-conf-配置"><a href="#修改-sysctl-conf-配置" class="headerlink" title="修改 sysctl.conf 配置"></a>修改 sysctl.conf 配置</h2><p>Linux 对于非 root 用户禁止使用 1024 以下端口，但为了避免 VNC 服务被防火墙阻挡，应将 VNC 服务端口调整到 80 。修改 sysctl.conf 文件配置达到此目的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#临时生效</span><br><span class="line">sysctl net.ipv4.ip_unprivileged_port_start&#x3D;0</span><br><span class="line"></span><br><span class="line">#永久生效</span><br><span class="line">echo &quot;net.ipv4.ip_unprivileged_port_start&#x3D;0&quot; &gt;&gt; &#x2F;etc&#x2F;sysctl.conf</span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure>

<h1 id="启动-VNC-服务"><a href="#启动-VNC-服务" class="headerlink" title="启动 VNC 服务"></a>启动 VNC 服务</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 设置 VNC 客户端连接密码</span><br><span class="line">vncpasswd</span><br><span class="line"></span><br><span class="line"># 启动 VNC 服务</span><br><span class="line">vncserver -kill :1</span><br><span class="line">vncserver :1</span><br><span class="line">vncserver -list</span><br></pre></td></tr></table></figure>

<h1 id="连接-VNC-服务"><a href="#连接-VNC-服务" class="headerlink" title="连接 VNC 服务"></a>连接 VNC 服务</h1><p>使用各种 VNC 客户端，填入相关配置连接即可。连接 VNC 服务器遇到一些问题，记录如下。</p>
<h2 id="中文输入法问题"><a href="#中文输入法问题" class="headerlink" title="中文输入法问题"></a>中文输入法问题</h2><p>打开终端，输入如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fcitx-autostart</span><br><span class="line">fcitx restart</span><br></pre></td></tr></table></figure>

<h2 id="输入正确用户名和密码仍旧跳回登录界面"><a href="#输入正确用户名和密码仍旧跳回登录界面" class="headerlink" title="输入正确用户名和密码仍旧跳回登录界面"></a>输入正确用户名和密码仍旧跳回登录界面</h2><p>原因是主目录下的 .Xauthority 文件拥有者变成了 root ，导致用户登录时无法获取该文件，解决方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chown user:user .Xauthority</span><br></pre></td></tr></table></figure>

<h2 id="麒麟-V10-自带的-Remmina-无法连接-VNC-服务器的问题"><a href="#麒麟-V10-自带的-Remmina-无法连接-VNC-服务器的问题" class="headerlink" title="麒麟 V10 自带的 Remmina 无法连接 VNC 服务器的问题"></a>麒麟 V10 自带的 Remmina 无法连接 VNC 服务器的问题</h2><p>麒麟 V10 自带的 Remmina 能够连接 VNC 服务器的默认的 5801 端口，但是无法连接 VNC 服务器的 80 端口。该问题暂未解决。</p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a href="https://www.runoob.com/w3cnote/linux-check-port-usage.html" target="_blank" rel="noopener">Linux 查看端口占用情况</a>,by runoob.</li>
<li><a href="https://blog.51cto.com/lenglingx/6393402" target="_blank" rel="noopener">普通用户无法监听 80，443等低于1024端口解决办法</a>,lenglingx.</li>
<li><a href="https://blog.csdn.net/yanghonker/article/details/41928841" target="_blank" rel="noopener">Ubuntu Kylin 输入正确的账号密码，登陆后又跳回到登录界面 解决方案</a>,by YoungHonker.</li>
<li><a href="https://ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html" target="_blank" rel="noopener">Systemd 入门教程：命令篇</a>,by 阮一峰.</li>
<li><a href="https://www.ruanyifeng.com/blog/2018/03/systemd-timer.html" target="_blank" rel="noopener">Systemd 定时器教程</a>,by 阮一峰.</li>
<li><a href="https://ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html" target="_blank" rel="noopener">Systemd 入门教程：实战篇</a>,by 阮一峰.</li>
<li><a href="https://www.ruanyifeng.com/blog/2016/03/node-systemd-tutorial.html" target="_blank" rel="noopener">Node 应用的 Systemd 启动</a>,by 阮一峰.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://huangwang.github.io/2025/01/14/SQL%E5%88%A4%E6%96%AD%E5%AD%97%E6%AE%B5%E5%80%BC%E6%98%AF%E5%90%A6%E8%BF%9E%E7%BB%AD%E4%B8%8E%E6%98%AF%E5%90%A6%E4%BB%8E1%E5%BC%80%E5%A7%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jack Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack Huang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/01/14/SQL%E5%88%A4%E6%96%AD%E5%AD%97%E6%AE%B5%E5%80%BC%E6%98%AF%E5%90%A6%E8%BF%9E%E7%BB%AD%E4%B8%8E%E6%98%AF%E5%90%A6%E4%BB%8E1%E5%BC%80%E5%A7%8B/" itemprop="url">
                  SQL判断字段值是否连续与是否从1开始
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2025-01-14 22:53:29" itemprop="dateCreated datePublished" datetime="2025-01-14T22:53:29+08:00">2025-01-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2025-01-17 08:26:39" itemprop="dateModified" datetime="2025-01-17T08:26:39+08:00">2025-01-17</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近遇到一个运维问题，编写SQL语句判断某个字段是否从1开始，是否是连续的，记录一下问题解决过程。</p>
<h1 id="目标数据表结构"><a href="#目标数据表结构" class="headerlink" title="目标数据表结构"></a>目标数据表结构</h1><p>目标数据表 Department 结构如下：</p>
<table>
<thead>
<tr>
<th>departId</th>
<th>personId</th>
</tr>
</thead>
<tbody><tr>
<td>7523</td>
<td>7523001</td>
</tr>
<tr>
<td>7523</td>
<td>7523002</td>
</tr>
<tr>
<td>7523</td>
<td>7523003</td>
</tr>
<tr>
<td>7524</td>
<td>7524001</td>
</tr>
<tr>
<td>7524</td>
<td>7524002</td>
</tr>
<tr>
<td>7524</td>
<td>7524003</td>
</tr>
</tbody></table>
<h1 id="判断字段是否从1开始"><a href="#判断字段是否从1开始" class="headerlink" title="判断字段是否从1开始"></a>判断字段是否从1开始</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from Department a </span><br><span class="line">where a.personId in ( select * from ( select min(personId) as personId from Department b group by b.departId )) and mod(personId, 1000) !&#x3D;1</span><br></pre></td></tr></table></figure>

<h1 id="判断字段是否连续"><a href="#判断字段是否连续" class="headerlink" title="判断字段是否连续"></a>判断字段是否连续</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select * from </span><br><span class="line">( select b.personId,</span><br><span class="line">( select max(personId) </span><br><span class="line">from Department a </span><br><span class="line">where a.personId &lt; b.personId and a.departId &#x3D; b.departId ) as prePersonId </span><br><span class="line">from Department b )</span><br><span class="line">where personId - 1 &gt; prePersonId</span><br></pre></td></tr></table></figure>

<h1 id="参考连接"><a href="#参考连接" class="headerlink" title="参考连接"></a>参考连接</h1><ol>
<li><a href="https://blog.csdn.net/sqlserverdiscovery/article/details/12950259" target="_blank" rel="noopener">在论坛中出现的比较难的sql问题：7(子查询 判断某个字段的值是否连续)</a>,by LongRui888.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://huangwang.github.io/2024/12/25/%E6%B7%B1%E5%85%A5%E9%AB%98%E5%8F%AF%E7%94%A8%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E4%B8%8E%E8%AE%BE%E8%AE%A1%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jack Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack Huang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/12/25/%E6%B7%B1%E5%85%A5%E9%AB%98%E5%8F%AF%E7%94%A8%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E4%B8%8E%E8%AE%BE%E8%AE%A1%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" itemprop="url">
                  深入高可用系统原理与设计读书笔记
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2024-12-25 21:31:53" itemprop="dateCreated datePublished" datetime="2024-12-25T21:31:53+08:00">2024-12-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2025-02-09 22:50:58" itemprop="dateModified" datetime="2025-02-09T22:50:58+08:00">2025-02-09</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第一章：云原生技术概论"><a href="#第一章：云原生技术概论" class="headerlink" title="第一章：云原生技术概论"></a>第一章：云原生技术概论</h1><h2 id="云计算的演进变革"><a href="#云计算的演进变革" class="headerlink" title="云计算的演进变革"></a>云计算的演进变革</h2><h2 id="物理机时代"><a href="#物理机时代" class="headerlink" title="物理机时代"></a>物理机时代</h2><h3 id="虚拟化技术成熟"><a href="#虚拟化技术成熟" class="headerlink" title="虚拟化技术成熟"></a>虚拟化技术成熟</h3><blockquote>
<p>从虚拟化技术的发展中，我们看到业务的工作负载由物理机转向虚拟机，资源有了初级的隔离，并且分配/利用更加合理。</p>
</blockquote>
<h3 id="云计算技术成熟"><a href="#云计算技术成熟" class="headerlink" title="云计算技术成熟"></a>云计算技术成熟</h3><blockquote>
<p>对于 XaaS 的一路演进，可以简单归纳为：</p>
</blockquote>
<ul>
<li>有了 IaaS（Infrastructure as a Service，基础设施即服务），客户不用关注物理机器，只需关注基础架构及应用程序。</li>
<li>有了 PaaS（Platform as a Service，平台即服务），客户不用关注基础架构，只需关注应用程序。</li>
<li>有了 FaaS（Function as a Service，功能即服务），客户只需关注功能和数据。</li>
</ul>
<h3 id="容器技术的兴起"><a href="#容器技术的兴起" class="headerlink" title="容器技术的兴起"></a>容器技术的兴起</h3><blockquote>
<p>Docker 创新性地提出了“镜像”（image）的概念，实现了一种新型的应用打包、分发和运行机制，开发人员能够在几秒钟内完成应用程序的部署、运行，无需再担心环境不一致的问题。</p>
</blockquote>
<h2 id="云原生出现的背景"><a href="#云原生出现的背景" class="headerlink" title="云原生出现的背景"></a>云原生出现的背景</h2><blockquote>
<p>部分软件已经变成水电煤一样的社会经济中的基础设施。</p>
</blockquote>
<blockquote>
<p>过去二十年间，云的底层基础设施和平台越来越强大，软件架构的发展也逐渐和云匹配：</p>
</blockquote>
<ul>
<li>通过不可变基础设施（镜像）解决本地和远程一致性问题；</li>
<li>通过服务网格（ServiceMesh）将非业务逻辑从应用程序中剥离；</li>
<li>通过声明式 API 描述应用程序的状态，而不用管中间的处理过程；</li>
<li>通过 DevOps 方法论以及一系列工具来提升研发/运维效率…</li>
</ul>
<blockquote>
<p>应用程序中的非业务逻辑不断被剥离，并下沉到云/基础设施层，代码越来越轻量。由此，工程师的开发工作回归本质（软件开发的本质是解决业务需求，各类“高深”、“复杂”的技术难题是业务需求的副产物，并不是软件开发的主题）。</p>
</blockquote>
<h2 id="云原生的定义"><a href="#云原生的定义" class="headerlink" title="云原生的定义"></a>云原生的定义</h2><blockquote>
<p>CNCF 云原生的定义 v1.0 版本</p>
</blockquote>
<blockquote>
<p>云原生技术有利于各组织在公有云、私有云和混合云等新型动态环境中，构建和运行可弹性扩展的应用。云原生的代表技术包括容器、服务网格、微服务、不可变基础设施和声明式 API。</p>
</blockquote>
<blockquote>
<p>这些技术能够构建容错性好、易于管理和便于观察的松耦合系统。结合可靠的自动化手段，云原生技术使工程师能够轻松地对系统作出频繁和可预测的重大变更。</p>
</blockquote>
<h2 id="云原生的目标"><a href="#云原生的目标" class="headerlink" title="云原生的目标"></a>云原生的目标</h2><blockquote>
<p>云原生的几个关键目标:</p>
</blockquote>
<ul>
<li>可用（Available）：通过各种机制来实现应用的高可用，以保证服务提供的连续性。</li>
<li>规模（Scale）：要求云原生服务能够适应不同的规模（包括但不限于用户规模/部署规模/请求量），并能够在部署时动态分配资源，以便在不同的规模之间快速和平滑的伸缩。</li>
<li>敏捷（Agility）：快速响应市场需求。</li>
<li>成本（Cost）：充分有效的利用资源。</li>
</ul>
<h2 id="云原生代表技术"><a href="#云原生代表技术" class="headerlink" title="云原生代表技术"></a>云原生代表技术</h2><blockquote>
<p>云原生的代表技术：容器技术、微服务、服务网格、不可变基础设施、声明式设计以及 DevOps。</p>
</blockquote>
<h3 id="容器技术"><a href="#容器技术" class="headerlink" title="容器技术"></a>容器技术</h3><blockquote>
<p>Google Cloud 对容器的定义: 容器是轻量级应用代码包，它还包含依赖项，例如编程语言运行时的特定版本和运行软件服务所需的库。</p>
</blockquote>
<p>容器技术发展历程：</p>
<h4 id="chroot-阶段：隔离文件系统"><a href="#chroot-阶段：隔离文件系统" class="headerlink" title="chroot 阶段：隔离文件系统"></a>chroot 阶段：隔离文件系统</h4><p>chroot 被认为是最早的容器技术之一，它能将进程的根目录重定向到某个新目录，复现某些特定环境，同时也将进程的文件读写权限限制在该目录内。</p>
<h4 id="LXC-阶段：封装系统"><a href="#LXC-阶段：封装系统" class="headerlink" title="LXC 阶段：封装系统"></a>LXC 阶段：封装系统</h4><p>至 2013 年，Linux 虚拟化技术已基本成型，通过 cgroups、namespace 以及安全防护机制，大体上解决了容器核心技术“运行环境隔离”，但此时仍需等待另一项关键技术的出现，才能迎来容器技术的全面繁荣。</p>
<h4 id="Docker-阶段：封装应用"><a href="#Docker-阶段：封装应用" class="headerlink" title="Docker 阶段：封装应用"></a>Docker 阶段：封装应用</h4><p>Docker 的核心创新“容器镜像（container image）”：</p>
<ul>
<li>容器镜像打包了整个容器运行依赖的环境，以避免依赖运行容器的服务器的操作系统，从而实现“build once，run anywhere”。</li>
<li>容器镜像一但构建完成，就变成只读状态，成为不可变基础设施的一份子。</li>
<li>与操作系统发行版无关，核心解决的是容器进程对操作系统包含的库、工具、配置的依赖（注意，容器镜像无法解决容器进程对内核特性的特殊依赖）。</li>
</ul>
<h4 id="OCI-阶段：容器标准化"><a href="#OCI-阶段：容器标准化" class="headerlink" title="OCI 阶段：容器标准化"></a>OCI 阶段：容器标准化</h4><blockquote>
<p>OCI 组织着力解决容器的构建、分发和运行标准问题，其宗旨是制定并维护 OCI Specifications（容器镜像格式和容器运行时的标准规范）。</p>
</blockquote>
<blockquote>
<p>OCI 有了三个主要的标准：</p>
</blockquote>
<ul>
<li>OCI Runtime Spec（容器运行时标准）：定义了运行一个容器，如何管理容器的状态和生命周期，如何使用操作系统的底层特性（namespace、cgroups、pivot_root 等）。</li>
<li>OCI Image Spec（容器镜像标准）：定义了镜像的格式，配置（包括应用程序的参数、依赖的元数据格式、环境信息等），简单来说就是对镜像文件格式的描述。</li>
<li>OCI Distribution Spec（镜像分发标准）：定义了镜像上传和下载的网络交互过程的规范。</li>
</ul>
<h4 id="容器编排阶段：封装集群"><a href="#容器编排阶段：封装集群" class="headerlink" title="容器编排阶段：封装集群"></a>容器编排阶段：封装集群</h4><blockquote>
<p>以 Kubernetes 为代表的容器编排框架，就是把大型软件系统运行所依赖的集群环境也进行了虚拟化，让集群得以实现跨数据中心的绿色部署，并能够根据实际情况自动扩缩。</p>
</blockquote>
<blockquote>
<p>就像用 docker run 可以启动单个程序一样，现在用 kubectl apply -f 就能部署和运行一个分布式集群应用，而无需关心是在私有云还是公有云或者具体哪家云厂商上。</p>
</blockquote>
<h4 id="云原生阶段：百花齐放"><a href="#云原生阶段：百花齐放" class="headerlink" title="云原生阶段：百花齐放"></a>云原生阶段：百花齐放</h4><h3 id="微服务"><a href="#微服务" class="headerlink" title="微服务"></a>微服务</h3><blockquote>
<p> Netflix 云架构师 Adrian Cockcroft定义：微服务架构是一种面向服务的架构，由松耦合的具有有限上下文的元素组成。</p>
</blockquote>
<blockquote>
<p>Adrian Cockcroft 的观点中有两个核心概念：</p>
</blockquote>
<ul>
<li>松耦合（Loosely Coupled）：意味着每个服务可以独立的更新，更新一个服务无需要求改变其他服务。</li>
<li>限界上下文（Bounded Contexts）：意味着每个服务要有明确的边界性，你可以只关注自身软件的发布，而无需考虑谁在依赖你的发布版本。微服务和它的消费者严格通过 API 进行交互，不共享数据结构、数据库等。基于契约的微服务规范要求服务接口是稳定的，而且向下兼容。</li>
</ul>
<blockquote>
<p>微服务架构中，有一些必须解决的问题，如负载均衡、伸缩扩容、传输通讯等等，这些问题可以说只要是分布式架构的系统就无法完全避免。</p>
</blockquote>
<blockquote>
<p>Kubernetes 在基础设施层面，解决分布式系统问题的方案：</p>
</blockquote>
<ul>
<li>Kubernetes 用 CoreDNS 替代 Spring Cloud 服务发现组件 Eureka。</li>
<li>Kubernetes 用 Service/Load Balancer 替代 Spring Cloud 中的负载均衡组件 Ribbon。</li>
<li>Kubernetes 用 ConfigMap 替代 Spring Cloud 的配置中心 Config。</li>
<li>Kubernetes 用 Ingress 代替 Spring Cloud 的网关组件 Zuul。</li>
</ul>
<blockquote>
<p>当虚拟化的基础设施从单个服务的容器扩展至由多个容器构成的服务集群，并开始解决分布式的问题。</p>
</blockquote>
<h3 id="服务网格"><a href="#服务网格" class="headerlink" title="服务网格"></a>服务网格</h3><blockquote>
<p>服务网格（Service Mesh）的概念最早由 Buoyant 公司的创始人 William Morgan 于 2016 年提出。</p>
</blockquote>
<blockquote>
<p>服务网格的定义</p>
<p>服务网格（ServiceMesh）是一个基础设施层，用于处理服务间通信。云原生应用有着复杂的服务拓扑，服务网格保证请求在这些拓扑中可靠地穿梭。在实际应用当中，服务网格通常是由一系列轻量级的网络代理组成的，它们与应用程序部署在一起，但对应用程序透明。</p>
<p>—— by William Morgan</p>
</blockquote>
<blockquote>
<p>业内绝大部分服务网格产品通常由“数据平面”和“控制平面”两部分组成:</p>
</blockquote>
<ul>
<li>数据平面（Data plane）：通常采用轻量级的网络代理（如 Envoy）作为 Sidecar，网络代理负责协调和控制服务之间的通信和流量处理，解决微服务之间服务熔断、负载均衡、安全通讯等问题。</li>
<li>控制平面（Control plane）：包含多个控制组件，它们负责配置和管理 Sidecar ，并提供服务发现（Discovery）、配置管理（Configuration）、安全控制（Certificates）等功能。</li>
</ul>
<h3 id="不可变基础设施"><a href="#不可变基础设施" class="headerlink" title="不可变基础设施"></a>不可变基础设施</h3><blockquote>
<p>可变的基础设施会导致以下问题：</p>
</blockquote>
<ul>
<li>重大故障时，难以快速重新构建服务：持续过多的手动操作并且缺乏记录，会导致很难由标准初始化的服务器来重新构建起等效的服务；</li>
<li>不一致风险：类似于程序变量因并发修改而带来的状态不一致风险。服务运行过程中，频繁的修改基础设施配置，同样会引入中间状态，导致出现无法预知的问题。</li>
</ul>
<blockquote>
<p>不可变基础设施思想的核心是，任何基础设施的运行实例一旦创建之后就变成只读状态。如需修改或升级，应该先修改基础设施的配置模版（例如 yaml、Dockerfile 配置），之后再使用新的运行实例替换。</p>
</blockquote>
<h3 id="声明式设计"><a href="#声明式设计" class="headerlink" title="声明式设计"></a>声明式设计</h3><blockquote>
<p>声明式设计是指一种软件设计理念：“我们描述一个事物的目标状态，而非达成目标状态的流程”。至于目标状态如何达成，则由相应的工具在其内部实现。</p>
</blockquote>
<blockquote>
<p>和声明式设计相对的是命令式设计（又叫过程式设计），两者的区别是：</p>
</blockquote>
<ul>
<li>命令式设计：命令“机器”如何去做事情（how），这样不管你想要的是什么（what），它都会按照你的命令实现；</li>
<li>声明式设计：告诉“机器”你想要的是什么（what），让机器想出如何去做（how）。</li>
</ul>
<h3 id="DevOps"><a href="#DevOps" class="headerlink" title="DevOps"></a>DevOps</h3><blockquote>
<p>DevOps 是个很复杂的概念，几句话很难解释清楚。我们延用之前的惯例，如果要理解一个复杂的概念，就先去了解它出现的背景，以及发展的历史。</p>
</blockquote>
<blockquote>
<p>DevOps 核心本质是解决软件开发生命周期中的管理问题，我们先从一种名为“瀑布模型”的项目管理方法说起。</p>
</blockquote>
<blockquote>
<p>虽然敏捷开发提升了开发效率，但它的范围仅限于开发和测试环节，并没有覆盖到部署环节。显然，运维部门并没有收益。相反的，甚至可以说“敏捷”加重了运维的负担。运维追求的目标是稳定，频繁变更是破坏稳定的根源。</p>
</blockquote>
<blockquote>
<p>DevOps 运动始于 2007 年左右，当时技术社区对开发与运维之间分开工作的方式以及由此引发的冲突感到担忧。</p>
</blockquote>
<blockquote>
<p>DevOps 的定义</p>
<p>DevOps（Development 和 Operations 的合成词）是一种重视“软件开发人员（Dev）”和“IT 运维技术人员（Ops）”之间沟通合作的文化、运动或惯例。</p>
<p>通过自动化“软件交付”和“架构变更”的流程，来使得构建、测试、发布软件能够更加地快捷、频繁和可靠。</p>
<p>—— from 维基百科</p>
</blockquote>
<blockquote>
<p>DevOps 的成功实践离不开工具上的支持，这其中包括最重要的自动化 CI/CD 流水线，通过自动化的方式打通软件从构建、测试到部署发布的整个流程。还有实时监控、事件管理、配置管理、协作平台等一系列工具/系统的配合。</p>
</blockquote>
<h1 id="第二章-构建“足够快”的网络服务"><a href="#第二章-构建“足够快”的网络服务" class="headerlink" title="第二章: 构建“足够快”的网络服务"></a>第二章: 构建“足够快”的网络服务</h1><h2 id="HTTPS-请求优化分析"><a href="#HTTPS-请求优化分析" class="headerlink" title="HTTPS 请求优化分析"></a>HTTPS 请求优化分析</h2><p>一个完整、未复用连接的 HTTPS 请求需要经过以下 5 个阶段：DNS 域名解析、TCP 握手、SSL 握手、服务器处理、内容传输。</p>
<p>RTT（Round-Trip Time）一个网络数据包从起点到目的地然后再回到起点所花费的时长。</p>
<p>TTFB（Time To First Byte，首字节时间）指从浏览器请求页面到接收来自服务器发送的信息的第一个字节的时间。</p>
<h2 id="网络拥塞控制原理与实践"><a href="#网络拥塞控制原理与实践" class="headerlink" title="网络拥塞控制原理与实践"></a>网络拥塞控制原理与实践</h2><p>网络吞吐量与 RTT、带宽密切相关：</p>
<ul>
<li>RTT 越低，数据传输的延迟越低；</li>
<li>带宽越高，网络在单位时间内传输的数据越多。</li>
</ul>
<p>一些术语：</p>
<ul>
<li>RTprop (Round-Trip propagation time，两个节点之间最小时延)：该值取决于物理距离，距离越长，时延越大。</li>
<li>BtlBw（Bottleneck Bandwidth，瓶颈带宽）：如果把网络链路想象成水管，RTprop 是水管的长度，BtlBw 则是水管最窄处的直径。</li>
<li>BDP（Bandwidth-Delay Product，带宽、时延的乘积）：它代表了网络上能够同时容纳的数据量（水管中有多少流动的水）。 BDP 的计算公式是：BDP = 带宽 × 时延。其中，带宽以比特每秒（bps）为单位，时延以秒为单位。</li>
<li>inflight 数据：指已经发送出去但尚未收到确认的数据包。这些数据包仍在网络中传输，等待接收方的处理或确认。</li>
</ul>
<h2 id="QUIC-设计原理与实践"><a href="#QUIC-设计原理与实践" class="headerlink" title="QUIC 设计原理与实践"></a>QUIC 设计原理与实践</h2><p>QUIC（Quick UDP Internet Connection，快速 UDP 网络连接）是一种基于 UDP 封装的安全可靠传输协议，旨在取代 TCP，成为新一代互联网的主流传输协议。</p>
<h1 id="第三章：深入-Linux-内核网络技术"><a href="#第三章：深入-Linux-内核网络技术" class="headerlink" title="第三章：深入 Linux 内核网络技术"></a>第三章：深入 Linux 内核网络技术</h1><h2 id="Linux-内核网络框架"><a href="#Linux-内核网络框架" class="headerlink" title="Linux 内核网络框架"></a>Linux 内核网络框架</h2><p>从 Linux 内核 2.4 版本开始，内核引入了一套通用的过滤框架 —— Netfilter，允许外界对网络数据包在内核协议栈流转过程中进行代码干预。</p>
<p>Linux 系统中的各类网络功能，如地址转换、封包处理、地址伪装、协议连接跟踪、数据包过滤、透明代理、带宽限速和访问控制等，都是基于 Netfilter 提供的代码拦截机制实现的。可以说，Netfilter 是整个 Linux 网络系统最重要（没有之一）的基石。</p>
<h2 id="内核旁路技术"><a href="#内核旁路技术" class="headerlink" title="内核旁路技术"></a>内核旁路技术</h2><p>对于网络密集型应用，内核态与用户态的频繁切换、复杂的网络协议栈处理，常常使 Linux 内核成为性能瓶颈。</p>
<p>在人们想办法提升 Linux 内核性能的同时，另外一批人抱着它不行就绕开它想法，提出了一种“内核旁路“（Kernel bypass）思想的技术方案。其中，DPDK 和 XDP 是主机内“内核旁路”思想的代表技术，RDMA 是主机之间“内核旁路”思想的代表技术。</p>
<h2 id="Linux-网络虚拟化"><a href="#Linux-网络虚拟化" class="headerlink" title="Linux 网络虚拟化"></a>Linux 网络虚拟化</h2><h3 id="虚拟网络通信技术"><a href="#虚拟网络通信技术" class="headerlink" title="虚拟网络通信技术"></a>虚拟网络通信技术</h3><blockquote>
<p>基于物理设备实现的网络拓扑结构是相对固定的，很难跟得上云原生时代下系统频繁变动的频率。例如，容器的动态扩缩容、集群跨数据中心迁移等等，都要求网络拓扑随时做出调整。正因为如此，软件定义网络（Software Defined Networking，SDN）的需求变得前所未有的迫切。</p>
</blockquote>
<blockquote>
<p>SDN 思想的核心是，在现有的物理网络之上新增一层虚拟网络，将控制平面（操作系统和各类网络控制软件等）和数据平面（底层通信的物理设备，以及各类通信协议等）解耦，将网络服务从底层硬件设备中抽象出来，由代码直接编程控制。</p>
</blockquote>
<blockquote>
<p>SDN 网络模型如图 3-16 所示：</p>
</blockquote>
<ul>
<li>位于下层的网络称 Underlay 网络，它是由路由器、交换机等硬件设备互联而成的物理网络，负责网络之间的数据传输；</li>
<li>位于上层的网络称 Overlay 网络，它是采用多种网络虚拟化技术在 Underlay 网络之上创建的虚拟网络。</li>
</ul>
<h1 id="第四章：负载均衡与代理技术"><a href="#第四章：负载均衡与代理技术" class="headerlink" title="第四章：负载均衡与代理技术"></a>第四章：负载均衡与代理技术</h1><h2 id="负载均衡与代理"><a href="#负载均衡与代理" class="headerlink" title="负载均衡与代理"></a>负载均衡与代理</h2><p>从处理请求的网络层次角度看，所有的负载均衡器可归纳为两大类：四层负载均衡和七层负载均衡，分别对应 OSI 模型的第四层（传输层）和第七层（应用层）。</p>
<p>“四层负载均衡”并非严格限定于 OSI 模型的第四层（传输层）。实际上，它的工作模式涉及多个网络层次：</p>
<ul>
<li>第二层（数据链路层）：通过修改帧头中的 MAC 地址，将请求从一个物理网络节点转发到另一个节点。这种方式通常用于同一广播域内的转发，例如交换机或桥接设备完成的二层转发操作。</li>
<li>第三层（网络层）：通过修改 IP 地址，实现跨子网的请求路由和转发。这是路由器的核心功能，通过修改数据包的源或目的 IP 地址，实现子网之间的通信和流量转发。</li>
<li>第四层（传输层）：通过修改 TCP/UDP 端口号或连接的目标地址，利用网络地址转换（NAT）技术隐藏内部网络结构，将请求从一个入口转发至多个后端服务。</li>
</ul>
<p>七层负载均衡器工作在应用层，这意味着负载均衡器必须与后端服务器建立新的传输层连接，并将客户端的请求代理到后端服务器。</p>
<p>七层负载均衡器工作在应用层，因此能够检测和处理请求内容，包括：</p>
<ul>
<li>安全层 TLS 协议：TLS 的归属层次在网络领域存在争议，本文为便于讨论假设属于应用层。</li>
<li>物理 HTTP 协议：涵盖 HTTP/1、HTTP/2、HTTP/3 等版本。</li>
<li>逻辑 HTTP 协议：包括请求的头部、主体和尾部数据。</li>
<li>消息协议：如 gRPC、RESTful API、SOAP、AMQP、MQTT 等。</li>
</ul>
<h2 id="负载均衡部署拓扑"><a href="#负载均衡部署拓扑" class="headerlink" title="负载均衡部署拓扑"></a>负载均衡部署拓扑</h2><h2 id="四层负载均衡技术"><a href="#四层负载均衡技术" class="headerlink" title="四层负载均衡技术"></a>四层负载均衡技术</h2><p>四层负载均衡器的典型代表是 LVS（Linux Virtual Server，Linux 虚拟服务器），由中国程序员章文嵩于 1998 年发起和开发。</p>
<h1 id="第五章：数据一致性与分布式事务"><a href="#第五章：数据一致性与分布式事务" class="headerlink" title="第五章：数据一致性与分布式事务"></a>第五章：数据一致性与分布式事务</h1><h2 id="数据一致性"><a href="#数据一致性" class="headerlink" title="数据一致性"></a>数据一致性</h2><p>引入事务的目的，是为了保证数据的“一致性”（Consistency）。</p>
<p>这里的一致性指的是，对数据有特定的预期状态，任何数据更改操作必须满足这些状态约束（或者恒等条件）。</p>
<p>想要达成数据的一致性，需要 3 个方面的努力：</p>
<ul>
<li>原子性（Atomic）：“原子”通常指不可分解为更小粒度的东西。这里原子性描述的是，客户端发起一个请求（请求包含多个操作）在异常情况下的行为。例如，只完成了一部分写入操作，系统出现故障了（进程崩溃、网络中断、节点宕机）。把多个操作纳入到一个原子事务，万一出现上述故障导致无法完成最终提交时，则中止事务，丢弃或者撤销那些局部修改。</li>
<li>隔离性（Isolation）： 同时运行的事务不应互相干扰。例如，当一个事务执行多次写入操作时，其他事务应仅能观察到该事务的最终完成结果，而非中间状态。隔离性旨在防止多个事务交叉操作导致的数据不一致问题。</li>
<li>持久性（Durability）：事务处理完成后，对数据的修改应当是永久性的，即使系统发生故障也不会丢失。在单节点数据库中，持久性意味着数据已写入存储设备（如硬盘或 SSD）。而在分布式数据库中，持久性要求数据成功复制到多个节点。为确保持久性，数据库必须在完成数据复制后，才能确认事务已成功提交。</li>
</ul>
<p>这也就是常说的事务的“ACID 特性”。值得一提的是，对于一致性而言，更多的是指数据在应用层的外部表现。应用程序借助数据库提供的原子性、隔离性和持久性，来实现一致性目标。也就是说，A、I、D 是手段，C（Consistency）是 3 者协作的目标，弄到一块完全是为了读起来更顺口。</p>
<h2 id="一致性与可用性的权衡"><a href="#一致性与可用性的权衡" class="headerlink" title="一致性与可用性的权衡"></a>一致性与可用性的权衡</h2><p>CAP 是一致性与可用性权衡的理论，是理解分布式系统的起点。</p>
<p>1999 年，美国工程院院士 Eric A.Brewer 发表了论文《Harvest, Yield, and Scalable Tolerant Systems》[1] ，首次提出了“CAP 原理”（CAP Principle）。不过，彼时的 CAP 仅是一种猜想，尚未得到理论上的证明。2002 年，麻省理工学院的 Seth Gilbert 和 Nancy Lynch 用严谨的数学推理证明了 CAP 的正确性。此后，CAP 从原理转变成定理，在分布式系统领域产生了深远的影响。</p>
<p>CAP 定理描述的是一个分布式系统中，涉及共享数据问题时，以下三个特性最多只能满足两个。</p>
<ul>
<li>一致性（Consistency）：意味着数据在任何时刻、任何节点上看到的都是符合预期的。为了确保定义的严谨性，学术研究中通常将一致性定义为“强一致性”（Strong Consistency），也称为“线性一致性”（Linearizability）。</li>
<li>可用性（Availability）：可用性代表系统持续提供服务的能力。要理解可用性，首先需要了解两个密切相关的指标：可靠性（Reliability）和可维护性（Serviceability）。可靠性通过平均无故障时间（MTBF, Mean Time Between Failure）度量；可维护性通过平均修复时间（MTTR, Mean Time To Repair）度量。可用性衡量系统在总时间内可以正常使用的时间比例，计算公式为 A = MTBF / (MTBF + MTTR)。因此，可用性是通过可靠性和可维护性计算得出的比例。例如，99.9999% 的可用性意味着平均每年系统故障修复时间为 32 秒。</li>
<li>分区容错性（Partition tolerance）：当部分节点由于网络故障或通信中断而无法相互联系，形成“网络分区”时，系统仍能够继续正确地提供服务。</li>
</ul>
<p>由于 CAP 定理已有严格的证明，我们不再探讨为何 CAP 不可兼得，直接分析舍弃 C、A、P 时所带来的不同影响。</p>
<ul>
<li>放弃分区容忍性（CA without P）：意味着我们将假设节点之间通信永远可靠。永远可靠的通信在分布式系统中必定不成立，只要依赖网络共享数据，分区现象就不可避免地存在。如果没有 P（分区容错性），也就谈不上是真正的分布式系统。</li>
<li>放弃可用性（CP without A）：意味着我们将假设一旦网络发生分区，节点之间的信息同步时间可以无限制延长。在现实中，选择放弃可用性系统（又称为 CP 系统）适用于对数据一致性有严格要求的场景，如金融系统、库存管理系统等。这些应用场景中，数据的一致性和准确性通常比系统的可用性更为重要。</li>
<li>放弃一致性（AP without C）：意味着在网络分区发生时，节点之间的数据可能会出现不一致。这种情况下，系统会优先保证可用性，而不是一致性。选择放弃一致性系统（又称 AP 系统）已经成为设计分布式系统的主流选择，因为分区容错性（P）是分布式网络的固有属性，不可避免；而可用性（A）通常是建设分布式系统的目标。如果系统在节点数量增加时可用性降低，则其分布式设计的价值也会受到质疑。除了像银行和证券这样的金融交易服务，这些场景中数据一致性至关重要，通常需要保证一致性而可能接受部分中断之外，大多数系统更倾向于在节点增多时保持高可用性，而不是牺牲可用性以维持一致性。</li>
</ul>
<blockquote>
<p>对于分布式系统而言，必须实现分区容错性（P）。因此，CAP 定理实际上要求在可用性（A）和一致性（C）之间选择，即在 AP 和 CP 之间权衡取舍。</p>
</blockquote>
<blockquote>
<p>工程师们又重新给一致性下了定义，将 CAP、ACID 中讨论的一致性（C）称为“强一致性”，而把牺牲了 C 的 AP 系统但又要尽可能获得正确结果的行为称为追求“弱一致性”。不过，若只是单纯地谈论“弱一致性”，通常意味着不保证一致性。在弱一致性中，工程师们进一步总结出了一种较强的特例，称为“最终一致性”（Eventual Consistency），它由 eBay 的系统架构师 Dan Pritchett 在 BASE 理论中提出。</p>
</blockquote>
<h2 id="分布式事务模型"><a href="#分布式事务模型" class="headerlink" title="分布式事务模型"></a>分布式事务模型</h2><h3 id="可靠事件队列"><a href="#可靠事件队列" class="headerlink" title="可靠事件队列"></a>可靠事件队列</h3><p>2008 年，eBay 架构师 Dan Pritchett 在 ACM 发表了论文《Base: An Acid Alternative》[1]。这篇论文中，作者基于实践总结出一种独立于 ACID 之外，通过消息队列和幂等机制来达成数据一致性的技术手段，并提出了“最终一致性”的概念。</p>
<p>BASE 是“Basically Available”、“Soft State”和“Eventually Consistent”的缩写，其核心理念为：</p>
<ul>
<li>基本可用（Basically Available）：系统保证在大多数情况下能够提供服务，即使某些节点出现故障时，仍尽可能保持可用性。这意味着系统优先保障可用性，而非一致性。</li>
<li>柔性状态（Soft state）：系统状态允许在一段时间内处于不一致状态。与 ACID 强一致性的要求不同，BASE 允许系统在更新过程处于“柔性”状态，即数据在某些节点上可以暂时不一致。</li>
<li>最终一致性（Eventually consistent）：最终一致性强调，即使在网络分区或系统故障的情况下，在经过足够的时间和多次数据同步操作后，所有节点的数据一定会一致。</li>
</ul>
<h2 id="服务幂等性设计"><a href="#服务幂等性设计" class="headerlink" title="服务幂等性设计"></a>服务幂等性设计</h2><p>幂等性是一个数学概念，后来被引入计算机科学中，用来描述某个操作可以安全地重试，即多次执行的结果与单次执行的结果完全一致。</p>
<h1 id="第六章：分布式共识及算法"><a href="#第六章：分布式共识及算法" class="headerlink" title="第六章：分布式共识及算法"></a>第六章：分布式共识及算法</h1><blockquote>
<p>世界上只有一种共识算法，就是 Paxos，其他所有的共识算法都是 Paxos 的退化版本。</p>
</blockquote>
<h2 id="什么是共识"><a href="#什么是共识" class="headerlink" title="什么是共识"></a>什么是共识</h2><p>尽管“共识”和“一致”在汉语中含义相近，但在计算机领域，这两个术语具有截然不同的含义：</p>
<ul>
<li>共识（Consensus）：指所有节点就某项操作（如选主、原子事务提交、日志复制、分布式锁管理等）达成一致的实现过程。</li>
<li>一致性（Consistency）：描述多个节点的数据是否保持一致，关注数据最终达到稳定状态的结果。</li>
</ul>
<blockquote>
<p>在分布式系统中，节点故障不可避免，但部分节点故障不应该影响系统整体状态。通过增加节点数量，依据“少数服从多数”原则，只要多数节点（至少  N/2+1 ）达成一致，其状态即可代表整个系统。这种依赖多数节点实现容错的机制称为 Quorum 机制。</p>
</blockquote>
<blockquote>
<p>Quorum 机制</p>
</blockquote>
<ul>
<li>3 节点集群：Quorum 为 2，允许 1 个节点故障；</li>
<li>4 节点集群：Quorum 为 3，允许 1 个节点故障；</li>
<li>5 节点集群：Quorum 为 3，允许 2 个节点故障。<blockquote>
<p>节点个数为 N 的集群，能容忍 (N−1)/2 个节点故障。你注意到了么？3 节点和 4 节点集群的故障容忍性一致。所以，一般情况下，以容错为目的的分布式系统没必要使用 4 个节点。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>根据上述的讨论，基于 Quorum 的机制，在不可靠的环境下，通过“少数服从多数”协商机制达成一致的决策，从而对外表现为一致的运行结果。这一过程被称为节点间的“协商共识”。</p>
</blockquote>
<blockquote>
<p>一旦解决共识问题，便可提供一套屏蔽内部复杂性的抽象机制，为应用层提供一致性保证，满足多种需求，例如：</p>
</blockquote>
<ul>
<li>主节点选举</li>
<li>原子事务提交</li>
<li>分布式锁管理</li>
<li>日志复制</li>
</ul>
<h2 id="Paxos-算法"><a href="#Paxos-算法" class="headerlink" title="Paxos 算法"></a>Paxos 算法</h2><blockquote>
<p>Paxos 算法由 Leslie Lamport[1] 于 1990 年提出，是一种基于消息传递、具备高度容错特性的共识算法，是当今分布式系统中最重要的理论基础，几乎就是“共识系统”的代名词。<br>Lamport 在分布式系统理论方面有非常多的成就，比如 Lamport 时钟、拜占庭将军问题、Paxos 算法等等。除了计算机领域之外，其他领域的无数科研工作者也要成天和 Lamport 开发的一套软件打交道，目前科研行业应用最广泛的论文排版系统 —— LaTeX (名字中的 La 就是指 Lamport)</p>
</blockquote>
<p>在 Paxos 算法中，节点分为三种角色：</p>
<ul>
<li>提议者（Proposer）：提议者是启动共识过程的节点，它提出一个值，请求其他节点对这个值进行投票，提出值的行为称为发起“提案”（Proposal），提案包含提案编号 (Proposal ID) 和提议的值 (Value)。注意的是，Paxos 算法是一个典型的为“操作转移”模型设计的算法，为简化表述，本文把提案类比成“变量赋值”操作，但你应该理解它是“操作日志”相似的概念，后面介绍的 Raft 算法中，直接就把“提案”称做“日志”了。</li>
<li>决策者（Acceptor）：接受或拒绝提议者发起的提案，如果一个提案被超过半数的决策者接受，意味着提案被“批准”（accepted）。提案一旦被批准，意味着在所有节点中达到共识，便不可改变、永久生效。</li>
<li>记录者（Learner）：记录者不发起提案，也不参与决策提案，它们学习、记录被批准的提案。</li>
</ul>
<h2 id="Raft-算法"><a href="#Raft-算法" class="headerlink" title="Raft 算法"></a>Raft 算法</h2><p>Paxos 算法中“节点众生平等”，每个节点都可以发起提案。多个提议者并行发起提案，是活锁、以及其他异常问题的源头。那如何不破坏 Paxos 的“节点众生平等”基本原则，又能在提案节点中实现主次之分，限制节点不受控的提案权利？</p>
<p>Raft 算法的设计机制是明确领导者、增加选举机制交接提案权利。Raft 算法中，节点分为以下三种角色：</p>
<ul>
<li>领导者（Leader）：负责处理所有客户端请求，将请求转换为“日志”复制到其他节点，不断地向所有节点广播心跳消息：“你们的领导还在，不要发起新的选举”。</li>
<li>跟随者（Follower）：接收、处理领导者的消息，并向领导者反馈日志的写入情况。当领导者心跳超时时，他会主动站起来，推荐自己成为候选人。</li>
<li>候选人（Candidate）：候选人属于过渡角色，他向所有的节点广播投票消息，如果他赢得多数选票，那么他将晋升为领导者；</li>
</ul>
<h1 id="第七章：容器编排技术"><a href="#第七章：容器编排技术" class="headerlink" title="第七章：容器编排技术"></a>第七章：容器编排技术</h1><blockquote>
<p>为了减轻管理容器的心智负担，实现容器调度、扩展、故障恢复等自动化机制，容器编排系统应运而生。过去十年间，Kubernetes 发展成为容器编排系统的事实标准，成为大数据分析、机器学习以及在线服务等领域广泛认可的最佳技术底座。</p>
<p>Kubernetes 在解决复杂问题的同时，本身也演变成当今最复杂的软件系统之一。目前，包括官方文档在内的大多数 Kubernetes 资料都聚焦于“怎么做”，鲜有解释“为什么这么做”。自 2015 年起，Google 陆续发布了《Borg, Omega, and Kubernetes》及《Large-scale cluster management at Google with Borg》等论文，分享了 Google 内部开发和运维 Borg、Omega 和 Kubernetes 系统的经验与教训。</p>
</blockquote>
<h2 id="容器编排系统的演进"><a href="#容器编排系统的演进" class="headerlink" title="容器编排系统的演进"></a>容器编排系统的演进</h2><blockquote>
<p>Google 先后设计了三套不同的容器管理系统，Borg、Omega 和 Kubernetes，并向外界分享了大量的设计思想、论文和源码，直接促进了容器技术的普及和发展，对整个行业的技术演进产生了深远的影响。</p>
</blockquote>
<blockquote>
<p>从 Borg 到 Kubernetes，容器技术的价值早已超越了单纯提升资源利用率。更深远的影响在于，系统开发和运维的理念从“以机器为中心”转变为“以应用为中心”：</p>
</blockquote>
<ul>
<li>容器封装了应用程序的运行环境，屏蔽了操作系统和硬件的细节，使得业务开发者不再需要关注底层实现；</li>
<li>基础设施团队可以更灵活地引入新硬件或升级操作系统，最大限度减少对线上应用和开发者的影响；</li>
<li>每个设计良好的容器通常代表一个应用，因此管理容器就等于管理应用，而非管理机器；</li>
<li>将收集的性能指标（如 CPU 使用率、内存用量、QPS 等）与应用程序而非物理机器关联，显著提高了应用监控的精确度和可观测性。</li>
</ul>
<h2 id="容器技术的原理与演进"><a href="#容器技术的原理与演进" class="headerlink" title="容器技术的原理与演进"></a>容器技术的原理与演进</h2><h3 id="文件系统隔离"><a href="#文件系统隔离" class="headerlink" title="文件系统隔离"></a>文件系统隔离</h3><blockquote>
<p>chroot 是“change root”的缩写，它允许管理员将进程的根目录锁定在特定位置，从而限制进程对文件系统的访问范围。chroot 的隔离功能对安全性至关重要。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir -p new-root&#x2F;&#123;bin,lib64,root&#125;</span><br><span class="line">$ cp &#x2F;bin&#x2F;bash new-root&#x2F;bin</span><br><span class="line">$ cp &#x2F;lib64&#x2F;&#123;ld-linux-x86-64.so*,libc.so*,libdl.so.2,libreadline.so*,libtinfo.so*&#125; new-root&#x2F;lib64</span><br><span class="line">$ sudo chroot new-root</span><br></pre></td></tr></table></figure>

<blockquote>
<p>除了 /bin 之外，如果我们将程序依赖的 /etc、/proc 等目录一同打包进去，实际上就得到了一个 rootfs 文件。因为 rootfs 包含的不仅是应用，还有整个操作系统的文件和目录，这意味着应用及其所有依赖都被封装在一起，这正是容器被广泛宣传为一致性解决方案的由来。</p>
</blockquote>
<h3 id="资源全方位隔离"><a href="#资源全方位隔离" class="headerlink" title="资源全方位隔离"></a>资源全方位隔离</h3><blockquote>
<p>从 Linux 内核 2.6.19 起，逐步引入了 UTS、IPC、PID、Network 和 User 等命名空间功能。到了 3.8 版本，Linux 实现了容器所需的六项最基本的资源隔离机制。Linux 4.6 版本起，新增了 Cgroup 和 Time 命名空间。</p>
</blockquote>
<h3 id="资源全方位限制"><a href="#资源全方位限制" class="headerlink" title="资源全方位限制"></a>资源全方位限制</h3><blockquote>
<p>进程的资源隔离已经完成，如果再对使用资源进行额度限制，就能对进程的运行环境实现“进乎完美”的隔离。这就要用 Linux 内核的第二项技术 —— Linux Control Cgroup（Linux 控制组群，简称 cgroups）。</p>
</blockquote>
<blockquote>
<p>cgroups 是 Linux 内核用于隔离、分配并限制进程组使用资源配额的机制。例如，它可以控制进程的 CPU 占用时间、内存大小、磁盘 I/O 速度等。</p>
</blockquote>
<h3 id="设计容器协作的方式"><a href="#设计容器协作的方式" class="headerlink" title="设计容器协作的方式"></a>设计容器协作的方式</h3><blockquote>
<p>登录到 Linux 机器后，执行 pstree -g 命令可以查看当前系统中的进程树状结构。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ pstree -g</span><br><span class="line">    |-rsyslogd(1089)-+-&#123;in:imklog&#125;(1089)</span><br><span class="line">    |  |-&#123;in:imuxsock) S 1(1089)</span><br><span class="line">    | &#96;-&#123;rs:main Q:Reg&#125;(1089)</span><br></pre></td></tr></table></figure>

<h3 id="超亲密容器组-Pod"><a href="#超亲密容器组-Pod" class="headerlink" title="超亲密容器组 Pod"></a>超亲密容器组 Pod</h3><blockquote>
<p>在 Kubernetes 中，与“进程组”对应的设计概念是 Pod。Pod 是一组紧密关联的容器集合，它们共享 IPC、Network 和 UTS 等命名空间，是 Kubernetes 管理的最基本单位。</p>
</blockquote>
<h2 id="容器镜像的原理与应用"><a href="#容器镜像的原理与应用" class="headerlink" title="容器镜像的原理与应用"></a>容器镜像的原理与应用</h2><blockquote>
<p>所谓的“容器镜像”，其实就是一个“特殊的压缩包”，它将应用及其依赖（包括操作系统中的库和配置）打包在一起，形成一个自包含的环境。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker build 镜像名称</span><br><span class="line"></span><br><span class="line">$ docker run 镜像名称</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Docker 镜像利用联合文件系统的分层设计。整个镜像从下往上由 6 个层组成：</p>
</blockquote>
<ul>
<li>最底层是基础镜像 Debian Stretch，相当于“base rootfs”，所有容器可以共享这一层；</li>
<li>接下来的 3 层是通过 Dockerfile 中的 ADD、ENV、CMD 等指令生成的只读层；</li>
<li>Init Layer 位于只读层和可写层之间，存放可能会被修改的文件，如 /etc/hosts、/etc/resolv.conf 等。这些文件原本属于 Debian 镜像，但容器启动时，用户往往会写入一些指定的配置，因此 Docker 为其单独创建了这一层；</li>
<li>最上层是通过 CoW（写时复制）技术创建的可写层（Read/Write Layer）。</li>
</ul>
<blockquote>
<p>通过镜像分层设计，以 Docker 镜像为核心，不同公司和团队的开发人员可以紧密协作。每个人不仅可以发布基础镜像，还可以基于他人的基础镜像构建和发布自己的软件。镜像的增量操作使得拉取和推送内容也是增量的，这远比操作虚拟机动辄数 GB 的 ISO 镜像要更敏捷。</p>
</blockquote>
<h2 id="容器持久化存储设计"><a href="#容器持久化存储设计" class="headerlink" title="容器持久化存储设计"></a>容器持久化存储设计</h2><blockquote>
<p>Docker 通过将宿主机目录挂载到容器内部的方式，实现数据持久化存储。如图 7-21 所示，目前它支持三种挂载方式：bind mount、volume 和 tmpfs mount。</p>
</blockquote>
<h2 id="容器间通信的原理"><a href="#容器间通信的原理" class="headerlink" title="容器间通信的原理"></a>容器间通信的原理</h2><h2 id="资源弹性伸缩"><a href="#资源弹性伸缩" class="headerlink" title="资源弹性伸缩"></a>资源弹性伸缩</h2><h1 id="第八章：服务网格技术"><a href="#第八章：服务网格技术" class="headerlink" title="第八章：服务网格技术"></a>第八章：服务网格技术</h1><h2 id="什么是服务网格"><a href="#什么是服务网格" class="headerlink" title="什么是服务网格"></a>什么是服务网格</h2><blockquote>
<p>服务网格是一个处理服务通讯的专门的基础设施层。它的职责是在由云原生应用组成服务的复杂拓扑结构下进行可靠的请求传送。在实践中，它是一组和应用服务部署在一起的轻量级的网络代理，对应用服务透明。 </p>
<p>—— What’s a service mesh？And why do I need one?，William Morgan</p>
</blockquote>
<blockquote>
<p>服务网格是一个基础设施层，用于处理服务间通信。云原生应用有着复杂的服务拓扑，服务网格保证请求在这些拓扑中可靠地穿梭。在实际应用当中，服务网格通常是由一系列轻量级的网络代理组成的，它们与应用程序部署在一起，但对应用程序透明。</p>
</blockquote>
<h2 id="服务间通信的演化"><a href="#服务间通信的演化" class="headerlink" title="服务间通信的演化"></a>服务间通信的演化</h2><blockquote>
<p>实施微服务架构时，需要解决问题（服务注册、服务发现、负载均衡、熔断、限流等）的本质是保证服务间请求的可靠传递。站在业务的角度来看，无论上述逻辑设计的多么复杂，都不会影响业务请求本身的业务语义与业务内容发生任何变化，实施微服务架构的技术挑战和业务逻辑没有任何关系。</p>
</blockquote>
<blockquote>
<p>回顾前面提到的 TCP/IP 协议案例，我们思考是否服务间的通信是否也能像 TCP 协议栈那样：“人们基于 HTTP 协议开发复杂的应用，无需关心底层 TCP 协议如何控制数据包”。如果能把服务间通信剥离、并下沉到微服务基础层，工程师将不再浪费时间编写基础设施层的代码，而是将充沛的精力聚焦在业务逻辑上。</p>
</blockquote>
<blockquote>
<p>第一代服务网格由一系列独立运行的代理型服务（Sidecar）构成，但并没有思考如何系统化管理这些代理服务。为了提供统一的运维入口，服务网格继续演化出了集中式的控制面板（Control Plane）。</p>
</blockquote>
<blockquote>
<p>典型的第二代服务网格以 Google、IBM 和 Lyft 联合开发的 Istio 为代表。根据 Istio 的总体架构（见图 8-8），第二代服务网格由两大核心组成部分：一系列与微服务共同部署的边车代理（称为数据平面），以及用于管理这些代理的控制器（称为控制平面）。控制器向代理下发路由、熔断策略、服务发现等策略信息，代理根据这些策略处理服务间的请求。</p>
</blockquote>
<h2 id="数据平面的设计"><a href="#数据平面的设计" class="headerlink" title="数据平面的设计"></a>数据平面的设计</h2><h2 id="控制平面的设计"><a href="#控制平面的设计" class="headerlink" title="控制平面的设计"></a>控制平面的设计</h2><h1 id="第九章：系统可观测性"><a href="#第九章：系统可观测性" class="headerlink" title="第九章：系统可观测性"></a>第九章：系统可观测性</h1><h2 id="什么是可观测性"><a href="#什么是可观测性" class="headerlink" title="什么是可观测性"></a>什么是可观测性</h2><blockquote>
<p>遥测数据（telemetry data）是指采样和汇总有关软件系统性能和行为的数据，这些数据（接口的响应时间、请求错误率、服务资源消耗等）用于监控和了解系统的当前状态。</p>
</blockquote>
<blockquote>
<p>实际上，软件领域的观测与上述火箭发射系统相似，都是通过全面收集系统运行数据（遥测数据），以了解内部状态。因此，观测本质上是一种数据收集与分析的科学，旨在帮助解决复杂系统中的故障检测、性能优化和风险预警等问题。</p>
</blockquote>
<h2 id="可观测性与传统监控"><a href="#可观测性与传统监控" class="headerlink" title="可观测性与传统监控"></a>可观测性与传统监控</h2><blockquote>
<p>可观测性与监控的关系</p>
</blockquote>
<blockquote>
<p>监控告诉我们系统哪些部分是正常的，可观测性告诉我们系统为什么不正常了。</p>
</blockquote>
<blockquote>
<p>——by《高性能 MySQL》作者 Baron Schwartz</p>
</blockquote>
<h2 id="遥测数据的分类与处理"><a href="#遥测数据的分类与处理" class="headerlink" title="遥测数据的分类与处理"></a>遥测数据的分类与处理</h2><blockquote>
<p>业界将系统输出的数据总结为三种独立的类型，它们的含义与区别如下：</p>
</blockquote>
<ul>
<li><p>指标（metric）：量化系统性能和状态的“数据点”，每个数据点包含度量对象（如接口请求数）、度量值（如 100 次/秒）和发生的时间，多个时间上连续的数据点便可以分析系统性能的趋势和变化规律。指标是发现问题的起点，例如你半夜收到一条告警：“12 点 22 分，接口请求成功率下降到 10%”，这表明系统出现了问题。接着，你挣扎起床，分析链路追踪和日志数据，找到问题的根本原因并进行修复。</p>
</li>
<li><p>日志（log）：系统运行过程中，记录离散事件的文本数据。每条日志详细描述了事件操作对象、操作结果、操作时间等信息。例如下面的日志示例，包含了时间、日志级别（ERROR）以及事件描述。日志为问题诊断提供了精准的上下文信息，与指标形成互补。当系统故障时，“指标”告诉你应用程序出现了问题，“日志”则解释了问题出现的原因。</p>
</li>
<li><p>链路追踪（trace）：记录请求在多个服务之间的“调用链路”（Trace），以“追踪树”（Trace Tree）的形式呈现请求的“调用”（span）、耗时分布等信息。</p>
</li>
</ul>
<h3 id="指标的处理"><a href="#指标的处理" class="headerlink" title="指标的处理"></a>指标的处理</h3><blockquote>
<p>为便于理解和使用不同类型的指标，Prometheus 定义了四种指标类型：</p>
</blockquote>
<ul>
<li>计数器（Counter）：一种只增不减的指标类型，用于记录特定事件的发生次数。常用于统计请求次数、任务完成数量、错误发生次数等。在监控 Web 服务器时，可以使用 Counter 来记录 HTTP 请求的总数，通过观察这个指标的增长趋势，能了解系统的负载情况；</li>
<li>仪表盘（Gauge）：一种可以任意变化的指标，用于表示某个时刻的瞬时值。常用于监控系统的当前状态，如内存使用量、CPU 利用率、当前在线用户数等；</li>
<li>直方图（Histogram）：用于统计数据在不同区间的分布情况。它会将数据划分到多个预定义的桶（bucket）中，记录每个桶内数据的数量。常用于分析请求延迟、响应时间、数据大小等分布情况。比如监控服务响应时间时，Histogram 可以将响应时间划分到不同的桶中，如 0-100ms、100-200ms 等，通过观察各个桶中的数据分布，能快速定位响应时间的集中区间和异常情况；</li>
<li>摘要（Summary）：和直方图类似，摘要也是用于统计数据的分布情况，但与直方图不同的是，Summary 不能提供数据在各个具体区间的详细分布情况，更侧重于单一实例（例如单个服务实例）的数据进行计算。</li>
</ul>
<h3 id="日志的索引与存储"><a href="#日志的索引与存储" class="headerlink" title="日志的索引与存储"></a>日志的索引与存储</h3><blockquote>
<p>处理日志本来是件稀松平常的事情，但随着数据规模的增长，量变引发质变，高吞吐写入（GB/s）、低成本海量存储（PB 级别）以及亿级数据的实时检索（1 秒内），已成为软件工程领域最具挑战性的难题之一。</p>
</blockquote>
<h3 id="分布式链路追踪"><a href="#分布式链路追踪" class="headerlink" title="分布式链路追踪"></a>分布式链路追踪</h3><blockquote>
<p>2010 年 4 月，Google 工程师发表了论文《Dapper, a Large-Scale Distributed Systems Tracing Infrastructure》[1]，论文总结了他们治理分布式系统的经验，并详细介绍了 Google 内部分布式链路追踪系统 Dapper 的架构设计和实现方法。</p>
</blockquote>
<p>如今的链路追踪系统大多以 Dapper 为原型设计，因为它们也统一继承了 Dapper 的核心概念：</p>
<ul>
<li>追踪（trace）：Trace 表示一次完整的分布式请求生命周期，它是一个全局上下文，包含了整个调用链所有经过的服务节点和调用路径。例如，用户发起一个请求，从前端服务到后端数据库的多次跨服务调用构成一个 Trace。</li>
<li>跨度（Span）：Span 是 Trace 中的一个基本单元，表示一次具体的操作或调用。一个 Trace 由多个 Span 组成，按时间和因果关系连接在一起。Span 内有描述操作的名称 span name、记录操作的开始时间和持续时间、Trace ID、当前 Span ID、父 Span ID（构建调用层级关系）等信息。</li>
</ul>
<h3 id="性能剖析"><a href="#性能剖析" class="headerlink" title="性能剖析"></a>性能剖析</h3><blockquote>
<p>可观测性领域的性能剖析（Profiling）的目标是分析运行中的应用，生成详细的性能数据（Profiles），帮助工程师全面了解应用的运行行为和资源使用情况，从而识别代码中的性能瓶颈。</p>
</blockquote>
<blockquote>
<p>性能数据通常以火焰图或堆栈图的形式呈现，分析这些数据是从“是什么”到“为什么”过程中的关键环节。</p>
</blockquote>
<blockquote>
<p>火焰图分析说明</p>
</blockquote>
<ul>
<li>纵轴：表示函数调用的堆栈深度（或层级）。纵向越高表示调用链越深，底部通常是程序的入口函数（如 main 函数），上层是被下层函数调用的函数。</li>
<li>横轴：表示函数在特定时间段内所占用的 CPU 时间或内存空间，条形的宽度越大，表示该函数消耗的时间或资源越多。</li>
</ul>
<p>分析火焰图的关键是观察横向条形的宽度，宽度越大，函数占用的时间越多。如果某个函数的条形图出现“平顶”现象，表示该函数的执行时间过长，可能成为性能瓶颈。</p>
<h3 id="核心转储"><a href="#核心转储" class="headerlink" title="核心转储"></a>核心转储</h3><blockquote>
<p>核心转储（Core dump）中的 “core” 代表程序的关键运行状态，“dump” 的意思是导出。</p>
</blockquote>
<h1 id="第十章-应用封装与交付"><a href="#第十章-应用封装与交付" class="headerlink" title="第十章 应用封装与交付"></a>第十章 应用封装与交付</h1><h2 id="“以应用为中心”的设计思想"><a href="#“以应用为中心”的设计思想" class="headerlink" title="“以应用为中心”的设计思想"></a>“以应用为中心”的设计思想</h2><blockquote>
<p>正是因为以应用为中心，整个云原生技术体系无限强调基础设施更好地服务于应用，以更高效的方式为应用提供基础设施能力，而不是反其道行之。而相应的，Kubernetes 也好、Docker 也好、Istio 也好，这些在云原生生态中起到了关键作用的开源项目，就是让这种思想落地的技术手段。</p>
</blockquote>
<h2 id="声明式管理的本质"><a href="#声明式管理的本质" class="headerlink" title="声明式管理的本质"></a>声明式管理的本质</h2><blockquote>
<p>分析 Kubernetes 的工作原理可以发现，无论是 kube-scheduler 调度 Pod，还是 Deployment 管理 Pod 部署，亦或是 HPA 执行弹性伸缩，它们的整体设计都遵循“控制器模式”。</p>
</blockquote>
<h2 id="从“封装配置”到“应用模型”"><a href="#从“封装配置”到“应用模型”" class="headerlink" title="从“封装配置”到“应用模型”"></a>从“封装配置”到“应用模型”</h2><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a href="https://www.thebyte.com.cn/intro.html" target="_blank" rel="noopener">深入高可用系统原理与设计</a>,by thebyte.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://huangwang.github.io/2024/12/24/VC6%E4%B9%8BMFC%E9%81%97%E7%95%99%E7%A8%8B%E5%BA%8F%E5%8D%87%E7%BA%A7%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jack Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack Huang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/12/24/VC6%E4%B9%8BMFC%E9%81%97%E7%95%99%E7%A8%8B%E5%BA%8F%E5%8D%87%E7%BA%A7%E6%96%B9%E6%B3%95/" itemprop="url">
                  VC6之MFC遗留程序升级方法
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2024-12-24 10:21:52" itemprop="dateCreated datePublished" datetime="2024-12-24T10:21:52+08:00">2024-12-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2025-01-05 11:22:01" itemprop="dateModified" datetime="2025-01-05T11:22:01+08:00">2025-01-05</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近拿到一个VC6 MFC编写的遗留程序源代码，需要将其升级到最新的Windows系统，记录一下升级过程。</p>
<h1 id="MFC程序执行流程"><a href="#MFC程序执行流程" class="headerlink" title="MFC程序执行流程"></a>MFC程序执行流程</h1><blockquote>
<p>程序是从Main（WinMain）开始和结束。 但是在Main（WinMain）开始之前会对全局的变量或者对象进行初始化。</p>
</blockquote>
<blockquote>
<p>故在MFC中，通过全局类（theApp） 的初始化， 进入theApp的构造函数，根据类的规则，初始子类的构造函数，必须先要运行父类的构造函数。 在这过程把包含WinMain的文件连接了进来。 这样就隐藏了WinMain函数。 </p>
</blockquote>
<blockquote>
<p>在WinMain函数中调用了AfxWinMain函数，在AfxWinMain函数中通过调用InitInstance函数完成了窗口的设计 窗口的注册 窗口的创建 窗口的显示和更新。然后在AfxWinMain中调用了Run方法，完成消息循环。</p>
</blockquote>
<h1 id="MFC扩展库BCGControlBar"><a href="#MFC扩展库BCGControlBar" class="headerlink" title="MFC扩展库BCGControlBar"></a>MFC扩展库BCGControlBar</h1><p>遗留程序依赖 MFC 扩展库BCGControlBar，因此需要安装和配置 BCGControlBar，否则编译链接出错。例如：</p>
<p>BCGCBProInc.h : No such s file or dictionary. 解决方案：安装BGB界面库</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>BCGControlBar是一个基于MFC的扩展库，您可以通过完全的用户化操作构成一些类似于Microsoft Office 2000/XP/2003和Microsoft Visual Studio.NET的应用程序（用户工具栏、菜单、键盘等等）。BCGControlBar库包含了大约150多个经过精心设计，测试和具有完备文档的MFC扩展类。这些都可以很容易的应用于您的应用程序，节省大量的开发和调试时间。</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>在编译之前，要先设置其附加包含目录和附加库目录。</p>
<p>vc6.0在其tools&gt;&gt;options&gt;&gt;directoris下进行设置。在show directories for选择include files，添加BCGControlBar安装目录下的BCGCBPro目录。</p>
<p>然后再选择show directories for下的Library files并添加BCGControlBar安装目录下的bin目录。</p>
<h1 id="MFC扩展库MapX"><a href="#MFC扩展库MapX" class="headerlink" title="MFC扩展库MapX"></a>MFC扩展库MapX</h1><p>遗留程序依赖 MFC 扩展库 MapX，因此需要安装和配置 MapX，否则编运行出错。</p>
<h2 id="MapX简介"><a href="#MapX简介" class="headerlink" title="MapX简介"></a>MapX简介</h2><p>MapX控件是Map Info公司向用户提供的具有强大地图分析功能的ActiveX控件，适用于大多数面向对象语言，可以无缝嵌入到各个领域的应用系统当中去。</p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a href="https://www.cnblogs.com/wenluderen/p/4952544.html" target="_blank" rel="noopener">深入跟踪MFC程序的执行流程</a>,by wenluderen</li>
<li><a href="https://www.cnblogs.com/Mars-0603/p/14922947.html" target="_blank" rel="noopener">【C++】MFC 程序入口和执行流程</a>,by 不溯流光.</li>
<li><a href="https://blog.csdn.net/qq_42444778/article/details/119109843" target="_blank" rel="noopener">MFC专业扩展库BCGControlBar：使用方法入门</a>,by 不如温暖过生活.</li>
<li><a href="https://www.cnblogs.com/vipwtl/p/6146333.html" target="_blank" rel="noopener">MFC BCGControlBar 安装及使用</a>,by VIPWTL.</li>
<li><a href="https://www.cnblogs.com/hao-hong-sheng/p/8513280.html" target="_blank" rel="noopener">MFC框架——单文档/多文档/对话框/多顶级文档的区别</a>,by 郝红升.</li>
<li><a href="https://blog.csdn.net/daizhiyan1/article/details/82769878" target="_blank" rel="noopener">MFC建立空文档失败分析</a>,by 咖啡熊猫.</li>
<li><a href="https://blog.csdn.net/elcarim/article/details/6773812" target="_blank" rel="noopener">关于VC++6.0重新安装falsed时出现的DCOM user account解决方案</a>,by miracle_dan.</li>
<li><a href="https://www.cnblogs.com/junlei/p/3635756.html" target="_blank" rel="noopener">VC下MapX开发环境建立</a>,by 风一兮.</li>
<li><a href="https://www.cnblogs.com/junlei/p/3635807.html" target="_blank" rel="noopener">用VC++对MapX进行二次开发总结</a>,by 风一兮.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://huangwang.github.io/2024/12/22/%E7%8E%B0%E4%BB%A3CSS%E9%87%8D%E7%BD%AE%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jack Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack Huang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/12/22/%E7%8E%B0%E4%BB%A3CSS%E9%87%8D%E7%BD%AE%E6%96%B9%E6%B3%95/" itemprop="url">
                  现代CSS重置方法
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2024-12-22 16:39:26 / 修改时间：16:43:56" itemprop="dateCreated datePublished" datetime="2024-12-22T16:39:26+08:00">2024-12-22</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>层叠样式表（Cascading Style Sheets，缩写为 CSS）是一种样式表语言，用来描述 HTML 或 XML（包括如 SVG、MathML 或 XHTML 之类的 XML 分支语言）文档的呈现方式。CSS 描述了在屏幕、纸质、音频等其他媒体上的元素应该如何被渲染的问题。</p>
</blockquote>
<p>通常在开始一个新的项目之前，应对CSS进行重置，建立一个基线，以便使网页在不同浏览器上有一致的显示。</p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a href="https://www.joshwcomeau.com/css/custom-css-reset/" target="_blank" rel="noopener">A Modern CSS Reset</a>,by joshwcomeau.</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS" target="_blank" rel="noopener">CSS：层叠样式表</a>,by mozilla.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://huangwang.github.io/2024/12/22/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%85%B3%E9%94%AE%E6%9C%AF%E8%AF%AD%E8%A7%A3%E9%87%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jack Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack Huang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/12/22/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%85%B3%E9%94%AE%E6%9C%AF%E8%AF%AD%E8%A7%A3%E9%87%8A/" itemprop="url">
                  计算机科学中的关键术语解释
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2024-12-22 16:32:07 / 修改时间：16:34:38" itemprop="dateCreated datePublished" datetime="2024-12-22T16:32:07+08:00">2024-12-22</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>记录计算机科学中一些关键术语的解释，方便以后教学。</p>
<h1 id="顺序、并发和并行执行"><a href="#顺序、并发和并行执行" class="headerlink" title="顺序、并发和并行执行"></a>顺序、并发和并行执行</h1><p>请参考<a href="https://www.rugu.dev/en/blog/concurrency-and-parallelism/" target="_blank" rel="noopener">Understanding Concurrency, Parallelism and JS</a></p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a href="https://www.rugu.dev/en/blog/concurrency-and-parallelism/" target="_blank" rel="noopener">Understanding Concurrency, Parallelism and JS</a>,by Uğur Erdem Seyfi.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://huangwang.github.io/2024/12/19/Linux%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jack Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack Huang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/12/19/Linux%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8%E6%96%B9%E6%B3%95/" itemprop="url">
                  Linux开机自启动方法
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2024-12-19 22:23:14" itemprop="dateCreated datePublished" datetime="2024-12-19T22:23:14+08:00">2024-12-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2025-01-14 22:48:39" itemprop="dateModified" datetime="2025-01-14T22:48:39+08:00">2025-01-14</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在使用 Linux 系统的过程中，默认有一个即时通讯软件开机自启动，想将该应用禁掉，不让其自启动。在 Linux 系统中，设置一个应用自启动的地方很多，遍布整个 Linux 启动流程。因此，首先了解 Linux 启动流程，再说明设置或禁用应用自启动的方法。</p>
<h1 id="Linux-开机启动流程"><a href="#Linux-开机启动流程" class="headerlink" title="Linux 开机启动流程"></a>Linux 开机启动流程</h1><p>Linux 开机启动流程如下：</p>
<ul>
<li>第一阶段：硬件引导启动阶段</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.1 POST(Power On Self Test) 加电自检</span><br><span class="line">1.2 BIOS</span><br><span class="line">	1.2.1 初始化硬件</span><br><span class="line">	1.2.2 查找启动介质</span><br><span class="line">		HDD: 查找启动硬盘的第一个扇区（MBR&#x2F;BootSector）</span><br><span class="line">1.3 MBR</span><br><span class="line">	1.3.1 Bootloader（启动装载程序）</span><br><span class="line">		GRUB</span><br><span class="line">		分区表</span><br></pre></td></tr></table></figure>

<ul>
<li>第二阶段：BootLoader 启动引导阶段</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">2.1 Stage1</span><br><span class="line">	执行 BootLoader 主程序(位于 MBR 前 446个字节)，它的作用是启动 Stage1.5 或 Stage2</span><br><span class="line">2.2 Stage1.5</span><br><span class="line">	Stage1.5 是桥梁，由于 Stage2 较大，存放在文件系统中，需要 Stage1.5 引导位于文件系统中的 Stage2</span><br><span class="line">2.3 Stage2</span><br><span class="line">	Stage2 是 GRUB 的核心映像</span><br><span class="line">2.4 grub.conf</span><br><span class="line">	Stage2 解析 grub.conf 配置文件，加载内核到内存中</span><br></pre></td></tr></table></figure>

<ul>
<li>第三阶段：内核引导阶段</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">3.1 &#x2F;boot&#x2F;kernel and Kernel parameter </span><br><span class="line">	内核初始化，加载基本的硬件驱动</span><br><span class="line">	</span><br><span class="line">3.2 &#x2F;boot&#x2F;initrd</span><br><span class="line">	引导 initrd 解压载入</span><br><span class="line">	3.2.1 阶段一：在内存中释放供 kernel 使用的 root filesystem</span><br><span class="line">				执行 initrd 文件系统中的 init，完成加载其他驱动模块</span><br><span class="line">	3.2.2 阶段二：执行真正的根文件系统中的 &#x2F;sbin&#x2F;init 进程</span><br></pre></td></tr></table></figure>

<ul>
<li>第四阶段：Sys V init 初始化阶段</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">4.1 &#x2F;sbin&#x2F;init</span><br><span class="line">	4.1.1 &#x2F;etc&#x2F;inittab</span><br><span class="line">		init 进程读取 &#x2F;etc&#x2F;inittab 文件，确定系统启动的运行级别</span><br><span class="line">	4.1.2 &#x2F;etc&#x2F;rc.d&#x2F;rc.sysinit</span><br><span class="line">		执行系统初始化脚本，对系统进行基本的配置</span><br><span class="line">	4.1.3 &#x2F;etc&#x2F;rc.d&#x2F;rcN.d</span><br><span class="line">		根据先前确定的运行级别启动对应运行级别中的服务</span><br><span class="line">	4.1.4 &#x2F;etc&#x2F;rc.d&#x2F;rc.local</span><br><span class="line">		执行用户自定义的开机启动程序</span><br><span class="line">4.2 登录</span><br><span class="line">	4.2.1 &#x2F;sbin&#x2F;mingetty (命令行登录)</span><br><span class="line">		验证通过 执行 &#x2F;etc&#x2F;login </span><br><span class="line">		加载 &#x2F;etc&#x2F;profile  ~&#x2F;.bash_profile  ~&#x2F;.bash_login  ~&#x2F;.profile</span><br><span class="line">		取得 non-login Shell</span><br><span class="line">		</span><br><span class="line">	4.2.2 &#x2F;etc&#x2F;X11&#x2F;prefdm (图形界面登录)</span><br><span class="line">		gdm kdm xdm</span><br><span class="line">		Xinit</span><br><span class="line">		加载 ~&#x2F;.xinitrc  ~&#x2F;.xserverrc</span><br></pre></td></tr></table></figure>

<ul>
<li>第五阶段：启动完成</li>
</ul>
<h1 id="设置应用自启动方法"><a href="#设置应用自启动方法" class="headerlink" title="设置应用自启动方法"></a>设置应用自启动方法</h1><p>从 Linux 开机流程可知，设置应用自启动主要在 Linux 启动流程的第四阶段。如果是服务或其他非 GUI 应用，可在 4.1 阶段设置开机自启动。如果是 GUI 应用，应在 4.2 阶段设置开机自启动。</p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a href="https://jaminzhang.github.io/linux/Linux-boot-process/" target="_blank" rel="noopener">Linux 系统启动流程</a>,by jaminzhang.</li>
<li><a href="https://blog.csdn.net/weixin_54015549/article/details/131457432" target="_blank" rel="noopener">Linux开机启动流程(超详细版)</a>,by Code_xw.</li>
<li><a href="https://zh.wikipedia.org/wiki/Initrd" target="_blank" rel="noopener">initrd</a>,by wikipedia.</li>
<li><a href="https://blog.csdn.net/gengzhikui1992/article/details/85624879" target="_blank" rel="noopener">linux启动流程——initrd和initramfs</a>,by 网络安全研发随想.</li>
<li><a href="https://xdaforums.com/t/info-boot-process-android-vs-linux.3785254/" target="_blank" rel="noopener">[INFO] BOOT PROCESS: ANDROID vs. LINUX</a>,by mirfatif.</li>
<li><a href="https://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html" target="_blank" rel="noopener">Systemd 入门教程：命令篇</a>,by 阮一峰.</li>
<li><a href="https://www.ruanyifeng.com/blog/2016/03/node-systemd-tutorial.html" target="_blank" rel="noopener">Node 应用的 Systemd 启动</a>,by 阮一峰.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://huangwang.github.io/2024/12/19/%E8%B4%B9%E6%9B%BC%E5%AD%A6%E4%B9%A0%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jack Huang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack Huang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/12/19/%E8%B4%B9%E6%9B%BC%E5%AD%A6%E4%B9%A0%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url">
                  费曼学习法学习笔记
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2024-12-19 12:45:33 / 修改时间：12:54:07" itemprop="dateCreated datePublished" datetime="2024-12-19T12:45:33+08:00">2024-12-19</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>费曼学习法是由著名物理学家、诺贝尔物理学奖得主理 查德·费曼提出的。其核心就是： 通过简短的语言，向别人清楚地解说一件事，来检验自己是否真的弄懂了这件事。</p>
<p>费曼学习法通过“ 以教促学”的方式让人在短时间内掌握知识，并且快速吸收信息。</p>
<p>费曼学习法可以简化为四个单词： concept（概念）、Teach（教给别人）、Review（评价）、Simplify（简化）。具体操作可概括四个步骤：</p>
<h1 id="第一步：选择目标"><a href="#第一步：选择目标" class="headerlink" title="第一步：选择目标"></a>第一步：选择目标</h1><blockquote>
<p>选择目标的选择很简单，就是确定你要学什么，或要干什么。在这里比如学习一门技术、学习一个科学领域、学习一门语言、学习一个概念等，都可以称作目标。</p>
</blockquote>
<blockquote>
<p>但如果想制定非常棒的目标，还可以学习一下 SMART 原则：Specific 具体、Measurable 可测量、Attainable 可实现、Relevant 相关性、Time—based 时效性。也就是说计划要具体、可测量、坚持即可实现、对你有意义并且要在一定的期限内完成。</p>
</blockquote>
<h1 id="第二步：教学"><a href="#第二步：教学" class="headerlink" title="第二步：教学"></a>第二步：教学</h1><blockquote>
<p>创造一个场景，在这个场景中将自己学到的知识讲授给 “别人”。在这个过程中会遇到很多问题，比如说不清楚，讲不明白，自己也模棱两可等，那就说明这些知识点并没有熟练掌握。尝试教授和发现薄弱点就是这一步的重点。</p>
</blockquote>
<h1 id="第三步：纠错学习"><a href="#第三步：纠错学习" class="headerlink" title="第三步：纠错学习"></a>第三步：纠错学习</h1><blockquote>
<p>在第二步中遇到了问题，那么就需要进入第三步 —— 纠错学习。无论是在教授的过程中说错的、说不清楚的、模棱两可的都需要在这一步中进行强化。反复查询资料、学习、强化记忆，然后再重复第二步进行验证，直到可以顺利的教授相应的知识。</p>
</blockquote>
<h1 id="第四步：简化"><a href="#第四步：简化" class="headerlink" title="第四步：简化"></a>第四步：简化</h1><blockquote>
<p>这一步是对上面学习的内容进行提炼、简化，去掉非必要的，多余的信息，并且能够用自己的语言通俗易懂的表达出来，而不是照本宣科。</p>
</blockquote>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a href="https://www.sohu.com/a/583465343_800763" target="_blank" rel="noopener">顶级认知的40大模型 | 第2期：费曼学习法 </a>,by 思铺学院.</li>
<li><a href="https://learnku.com/articles/35137" target="_blank" rel="noopener">世界上最好的学习法：费曼学习法</a>,by CrazyZard.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/52/">52</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Jack Huang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/%20%7C%7C%20archive">
                
                    <span class="site-state-item-count">515</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">65</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jack Huang</span>

  

  
</div>


  



  <div class="powered-by">由 <a class="theme-link" target="_blank" rel="external nofollow" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" rel="external nofollow" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a></div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.2.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.2.0"></script>



  



	





  





  






<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  
  

  

  

  

  

  

</body>
</html>
